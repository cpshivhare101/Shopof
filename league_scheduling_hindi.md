# लीग मैच शेड्यूलिंग आवश्यकताएँ (Hindi)

## परिचय
यह दस्तावेज लीग मैच शेड्यूलिंग सिस्टम की आवश्यकताओं को वर्णन करता है। इसका उद्देश्य यह सुनिश्चित करना है कि टीमें न्यूनतम निर्धारित मैच खेलें, और मैच जल्द से जल्द शेड्यूल हों। यूजर पैरामीटर्स प्रदान करेगा, और अगर कुछ पैरामीटर्स नहीं दिए गए, तो डिफॉल्ट वैल्यूज का उपयोग होगा। यह दस्तावेज AI और डेवलपर्स दोनों के लिए स्पष्ट और समझने योग्य है।

## मुख्य लक्ष्य
- प्रत्येक टीम कम से कम `min_games_per_team` मैच खेले।
- मैचों को `league_start_date` से शुरू करके `end_date` तक जल्द से जल्द शेड्यूल करना।
- संसाधनों (resources) का उपयोग यथासंभव बराबर करना, लेकिन यह अनिवार्य नहीं।
- अगर केवल दो टीमें हैं, तो वे एक-दूसरे के खिलाफ बार-बार खेल सकती हैं।
- बिना `number_of_teams` और `resources` के शेड्यूलिंग संभव नहीं।

## पैरामीटर्स
नीचे लीग शेड्यूलिंग के लिए यूजर द्वारा प्रदान किए जाने वाले पैरामीटर्स और उनके विवरण दिए गए हैं:

| पैरामीटर | प्रकार | विवरण | डिफॉल्ट वैल्यू |
|-----------|--------|-------|----------------|
| `league_start_date` | Date | लीग की शुरुआत की तारीख (उदाहरण: 2025-05-29) | आज की तारीख |
| `min_games_per_team` | Number | प्रत्येक टीम के लिए न्यूनतम मैचों की संख्या | 5 |
| `game_duration` | Number | प्रत्येक मैच की अवधि मिनटों में (उदाहरण: 60) | 60 |
| `number_of_teams` | Number | लीग में भाग लेने वाली टीमों की संख्या (अनिवार्य) | कोई डिफॉल्ट नहीं (अनिवार्य) |
| `resources` | Array | उपलब्ध संसाधन (उदाहरण: ['Court 1', 'Court 2']) (अनिवार्य) | कोई डिफॉल्ट नहीं (अनिवार्य) |
| `frequency` | String | मैच कितनी बार शेड्यूल होंगे (daily, weekly, monthly) | daily |
| `games` | Number | प्रति `frequency` अवधि में कितने मैच | 8 |
| `double_headers` | Object | बैक-टू-बैक मैचों के लिए नियम `{apply: Boolean, force: Boolean, same_resource: Boolean}` | `{apply: false, force: false, same_resource: false}` |
| `end_date` | Date | लीग की अंतिम तारीख | `league_start_date + 90 days` |
| `team_can_play` | Number | प्रति `frequency` अवधि में अधिकतम मैच (उदाहरण: 5 weekly → 5 मैच हफ्ते में) | कोई डिफॉल्ट नहीं |
| `debug` | Boolean | डिबगिंग के लिए | false |
| `teams_availability_or_not` | Array | टीमों की उपलब्धता/अनुपलब्धता नियम | [] (डिफॉल्ट: रोज़ 9:00 AM से 5:00 PM) |
| `resources_availability_or_not` | Array | संसाधनों की उपलब्धता/अनुपलब्धता नियम | [] (डिफॉल्ट: रोज़ 9:00 AM से 5:00 PM) |

### नोट
- `team_name` (उदाहरण: `Team 1`, `Team 2`) डेटाबेस में यूनिक है और इसका उपयोग टीमें पहचानने के लिए किया जाएगा। `team_id` अनिवार्य नहीं है।
- `resource_name` (उदाहरण: `Court 1`) डेटाबेस में यूनिक है। `resource_id` अनिवार्य नहीं है।

### डबल हेडर्स
- `double_headers.apply: true` → बैक-टू-बैक मैच शेड्यूल करने की कोशिश होगी।
- `double_headers.force: true` → बैक-टू-बैक मैच अनिवार्य होंगे। प्रत्येक टीम के लिए बैक-टू-बैक मैच शेड्यूल करना होगा, और अगर यह संभव नहीं है, तो सिस्टम उस टीम के लिए कोई मैच शेड्यूल नहीं करेगा या त्रुटि देगा।
- `double_headers.force: false` → सिस्टम डबल हेडर शेड्यूल करने की कोशिश करेगा, लेकिन अगर यह संभव नहीं है, तो सामान्य मैच शेड्यूलिंग होगी।
- `double_headers.same_resource: true` → बैक-टू-बैक मैच एक ही संसाधन पर होंगे। अगर `false`, तो अलग-अलग संसाधनों पर भी हो सकते हैं।
- अगर `apply: false`, तो कोई डबल हेडर शेड्यूल नहीं होंगे, और `force` या `same_resource` का कोई प्रभाव नहीं होगा।

### उपलब्धता नियम (Availability Rules)
`teams_availability_or_not` और `resources_availability_or_not` में उपलब्धता नियम शामिल हैं। प्रत्येक नियम में निम्नलिखित शामिल हैं:

| फ़ील्ड | प्रकार | विवरण |
|--------|--------|-------|
| `day` | Array | सप्ताह के दिन (उदाहरण: ['Monday', 'Tuesday']) |
| `from` | Time | शुरू होने का समय (उदाहरण: '10:00 AM') |
| `till` | Time | खत्म होने का समय (उदाहरण: '12:00 PM') |
| `effective_from` | Date | नियम कब से लागू होगा (उदाहरण: '2025-05-05') |
| `repeats` | String | दोहराव पैटर्न (weekly, monthly) |
| `can_play` | Boolean | क्या उस समय खेलना संभव है (true/false) |

#### repeats का व्यवहार
- **weekly**: हर हफ्ते दिए गए दिनों पर शेड्यूलिंग की कोशिश होगी (उदाहरण: Monday और Tuesday)।
- **monthly**: हर महीने के पहले दिए गए दिन (उदाहरण: Monday) को शेड्यूलिंग की कोशिश होगी। अगर पहला Monday संभव न हो, तो दूसरा, तीसरा, या चौथा Monday आजमाया जाएगा। प्रत्येक महीने में अधिकतम एक बार शेड्यूलिंग।

#### अतिरिक्त नियम (टीमों के लिए)
- `resources`: टीम किन संसाधनों पर खेल सकती है (उदाहरण: ['Court 1'])। अगर खाली (`[]`), तो सभी संसाधन।
- `cannot_play_against`: वे टीमें जिनके खिलाफ नहीं खेल सकती (उदाहरण: ['Team 2', 'Team 3'])। अगर खाली (`[]`), तो कोई प्रतिबंध नहीं।
- `cannot_play_at_same_time_as_another_team`: वे टीमें जिनके साथ एक ही समय पर नहीं खेल सकती (उदाहरण: ['Team 4'])। अगर खाली (`[]`), तो कोई प्रतिबंध नहीं।

### डिफॉल्ट व्यवहार
- अगर `teams_availability_or_not` में किसी टीम का ज़िक्र नहीं है, तो वह रोज़ 9:00 AM से 5:00 PM तक उपलब्ध मानी जाएगी, सभी संसाधनों पर खेल सकती है, और कोई `cannot_play_against` या `cannot_play_at_same_time_as_another_team` प्रतिबंध नहीं होगा।
- अगर `resources_availability_or_not` में किसी संसाधन का ज़िक्र नहीं है, तो वह रोज़ 9:00 AM से 5:00 PM तक उपलब्ध माना जाएगा।
- अगर `game_duration`, `frequency`, या `games` नहीं दिए गए, तो `teams_availability_or_not` और `resources_availability_or_not` प्रोग्रामेटिकली जनरेट होंगे, और डिफॉल्ट समय 9:00 AM से 5:00 PM होगा।

### न्यूनतम और अधिकतम मैच
- प्रत्येक टीम को कम से कम `min_games_per_team` मैच खेलने हैं।
- अगर सभी टीमें `min_games_per_team` तक पहुंच गई हैं, तो शेड्यूलिंग बंद हो जाएगी।
- अगर कुछ टीमें `min_games_per_team` तक नहीं पहुंची हैं, तो उनके लिए अतिरिक्त मैच शेड्यूल होंगे, भले ही दूसरी टीमें `min_games_per_team` से ज्यादा खेल चुकी हों।
- कोई अधिकतम मैच सीमा नहीं, लेकिन अतिरिक्त मैच केवल ज़रूरी होने पर शेड्यूल होंगे।

### मैच शेड्यूलिंग से पहले चेक
किसी भी मैच को शेड्यूल करने से पहले, `events` टेबल में निम्नलिखित चेक करना अनिवार्य है:
- **होम टीम**: उस तारीख और समय पर होम टीम का कोई और मैच नहीं होना चाहिए।
- **अवे टीम**: उस तारीख और समय पर अवे टीम का कोई और मैच नहीं होना चाहिए।
- **संसाधन**: उस तारीख और समय पर संसाधन (जैसे `Court 1`) पहले से बुक नहीं होना चाहिए।
- अगर ये तीनों उपलब्ध हैं, तो मैच शेड्यूल किया जाएगा। अन्यथा, सिस्टम अगला उपलब्ध स्लॉट ढूंढेगा जो सभी नियमों (`teams_availability_or_not`, `resources_availability_or_not`, आदि) को पूरा करता हो।
- यह सुनिश्चित करता है कि शेड्यूल किए गए मैचों में कोई टकराव (conflict) न हो।

### आउटपुट फॉर्मेट
शेड्यूल किए गए मैचों का आउटपुट एक सरणी के रूप में होगा, जिसमें प्रत्येक मैच के लिए निम्नलिखित जानकारी होगी:
- `home`: होम टीम का नाम (उदाहरण: `Team 1`)।
- `away`: अवे टीम का नाम (उदाहरण: `Team 2`)।
- `resource`: उपयोग किया गया संसाधन (उदाहरण: `Court 1`)।
- `date`: मैच की तारीख (उदाहरण: `Date.parse("2025-05-29")`)।
- `start_time`: मैच शुरू होने का समय (उदाहरण: `Time.parse("2025-05-29 09:00:00")`)।
- `end_time`: मैच खत्म होने का समय (उदाहरण: `Time.parse("2025-05-29 10:00:00")`)।
- `duration`: मैच की अवधि मिनटों में (उदाहरण: `60`)।

#### उदाहरण आउटपुट
```ruby
[
  { home: "Team 1", away: "Team 2", resource: "Court 1", date: Date.parse("2025-05-29"), start_time: Time.parse("2025-05-29 09:00:00"), end_time: Time.parse("2025-05-29 10:00:00"), duration: 60 },
  { home: "Team 3", away: "Team 4", resource: "Court 2", date: Date.parse("2025-05-29"), start_time: Time.parse("2025-05-29 09:00:00"), end_time: Time.parse("2025-05-29 10:00:00"), duration: 60 },
  { home: "Team 1", away: "Team 3", resource: "Court 1", date: Date.parse("2025-05-29"), start_time: Time.parse("2025-05-29 10:00:00"), end_time: Time.parse("2025-05-29 11:00:00"), duration: 60 },
  { home: "Team 2", away: "Team 4", resource: "Court 2", date: Date.parse("2025-05-29"), start_time: Time.parse("2025-05-29 10:00:00"), end_time: Time.parse("2025-05-29 11:00:00"), duration: 60 }
]
```
- वैकल्पिक रूप से, प्रत्येक शेड्यूल किया गया मैच `events` टेबल में स्टोर किया जा सकता है।

### उदाहरण
```ruby
league_params = {
  league_start_date: "2025-05-29",
  min_games_per_team: 2,
  game_duration: 60,
  number_of_teams: 4,
  end_date: "2025-08-27",
  resources: ["Court 1", "Court 2"],
  team_can_play: 5,
  games: "weekly",
  double_headers: {apply: true, force: true, same_resource: true},
  teams_availability_or_not: [],
  resources_availability_or_not: []
}
```
- **विवरण**:
  - लीग 2025-05-29 से शुरू होगी और 2025-08-27 तक चलेगी।
  - 4 टीमें (`Team 1`, `Team 2`, `Team 3`, `Team 4`), प्रत्येक को कम से कम 2 मैच खेलने हैं।
  - प्रत्येक मैच 60 मिनट का होगा।
  - संसाधन: `Court 1` और `Court 2`। मैच यथासंभव बराबर शेड्यूल होंगे।
  - **Team 1, Team 2, Team 3, Team 4**: रोज़ 9:00 AM से 5:00 PM तक उपलब्ध, किसी भी संसाधन पर खेल सकती हैं।
  - **Court 1, Court 2**: रोज़ 9:00 AM से 5:00 PM तक उपलब्ध।
  - डबल हेडर्स अनिवार्य हैं (`apply: true, force: true`), और बैक-टू-बैक मैच एक ही संसाधन पर होंगे (`same_resource: true`)।
  - प्रत्येक टीम एक हफ्ते में अधिकतम 5 मैच खेल सकती है।
  - प्रत्येक मैच को शेड्यूल करने से पहले, `events` टेबल में होम टीम, अवे टीम, और संसाधन की उपलब्धता चेक की जाएगी।

#### उदाहरण आउटपुट (डबल हेडर के साथ)
```ruby
[
  { home: "Team 1", away: "Team 2", resource: "Court 1", date: Date.parse("2025-05-29"), start_time: Time.parse("2025-05-29 09:00:00"), end_time: Time.parse("2025-05-29 10:00:00"), duration: 60 },
  { home: "Team 1", away: "Team 3", resource: "Court 1", date: Date.parse("2025-05-29"), start_time: Time.parse("2025-05-29 10:00:00"), end_time: Time.parse("2025-05-29 11:00:00"), duration: 60 },
  { home: "Team 2", away: "Team 4", resource: "Court 2", date: Date.parse("2025-05-29"), start_time: Time.parse("2025-05-29 09:00:00"), end_time: Time.parse("2025-05-29 10:00:00"), duration: 60 },
  { home: "Team 2", away: "Team 3", resource: "Court 2", date: Date.parse("2025-05-29"), start_time: Time.parse("2025-05-29 10:00:00"), end_time: Time.parse("2025-05-29 11:00:00"), duration: 60 }
]
```
- **विवरण**:
  - प्रत्येक टीम के 2 मैच बैक-टू-बैक शेड्यूल किए गए हैं:
    - `Team 1`: 9:00 AM और 10:00 AM (`Court 1` पर)।
    - `Team 2`: 9:00 AM और 10:00 AM (`Court 2` पर)।
  - `Team 3` और `Team 4` के मैच भी बैक-टू-बैक हैं, लेकिन अलग-अलग संसाधनों पर।
  - संसाधन उपयोग: `Court 1` (2 मैच), `Court 2` (2 मैच)।
  - `force: true` के कारण, सिस्टम ने सुनिश्चित किया कि प्रत्येक टीम के मैच बैक-टू-बैक हैं।

## निष्कर्ष
यह दस्तावेज लीग मैच शेड्यूलिंग की सभी आवश्यकताओं को स्पष्ट रूप से प्रस्तुत करता है। सिस्टम को उपलब्धता नियमों, डबल हेडर्स (अनिवार्य या वैकल्पिक), संसाधन उपयोग, और `events` टेबल में टकराव चेक को ध्यान में रखते हुए न्यूनतम मैच सुनिश्चित करना होगा। AI या डेवलपर इस दस्तावेज का उपयोग करके एक प्रभावी शेड्यूलिंग समाधान बना सकते हैं।
